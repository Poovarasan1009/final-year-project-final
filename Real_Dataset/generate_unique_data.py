"""
Script to:
1. Remove exact duplicate rows from training_data.csv (based on student_answer column)
2. Generate additional unique synthetic data to reach at least 5000 records
3. Save the cleaned + expanded dataset
"""

import csv
import random
import os

# ── paths ────────────────────────────────────────────────────────────────────
SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
INPUT_FILE  = os.path.join(SCRIPT_DIR, "training_data.csv")
OUTPUT_FILE = os.path.join(SCRIPT_DIR, "training_data_unique.csv")
TARGET_ROWS = 5000

# ── load & deduplicate ────────────────────────────────────────────────────────
print("Loading existing data …")
with open(INPUT_FILE, newline="", encoding="utf-8") as f:
    reader = csv.DictReader(f)
    rows = list(reader)

print(f"  Total rows before dedup : {len(rows)}")

seen_answers = set()
unique_rows  = []
for row in rows:
    key = row["student_answer"].strip().lower()
    if key not in seen_answers and key:
        seen_answers.add(key)
        unique_rows.append(row)

print(f"  Unique rows after dedup : {len(unique_rows)}")

# ── synthetic data to fill up to TARGET_ROWS ─────────────────────────────────
# Each topic has: question, ideal_answer, and a pool of varied student answers
# Each student answer gets a plausible score (0-100).

topics = [
    {
        "question": "What is photosynthesis?",
        "ideal_answer": "Photosynthesis is the process by which green plants and some other organisms use sunlight to synthesize foods from carbon dioxide and water. It generally involves the green pigment chlorophyll and generates oxygen as a byproduct.",
        "answers": [
            ("Plants convert sunlight into food using chlorophyll, CO2, and water, releasing oxygen.", 88),
            ("A biological process where light energy is converted to chemical energy stored in glucose.", 82),
            ("Plants use light to make food from CO2 and water. Chlorophyll absorbs sunlight.", 85),
            ("Green plants make their own food using sunlight, carbon dioxide, and water.", 80),
            ("The process by which plants produce glucose from carbon dioxide and water using sunlight.", 86),
            ("Chlorophyll in leaves captures solar energy to combine CO2 and water into sugars.", 84),
            ("A metabolic process in plants that converts light energy into chemical energy.", 78),
            ("Plants absorb sunlight with chlorophyll to make glucose and release oxygen.", 83),
            ("The light-dependent and light-independent reactions together convert CO2 into sugar.", 79),
            ("Photosynthesis happens in chloroplasts where light drives glucose synthesis.", 77),
            ("It involves absorbing carbon dioxide and water and releasing oxygen using light energy.", 76),
            ("Plants perform photosynthesis to create food stored as starch.", 68),
            ("Sunlight gives energy to plants to make food.", 55),
            ("Plants eat sunlight.", 22),
            ("I don't know about photosynthesis.", 5),
            ("It has something to do with leaves and sun.", 18),
            ("Photo means light. Plants use light to eat.", 25),
            ("Plants make sugar from sunlight.", 45),
            ("Chlorophyll is green and helps plants.", 30),
            ("Photosynthesis releases carbon dioxide and absorbs oxygen.", 10),
        ],
    },
    {
        "question": "What is artificial intelligence?",
        "ideal_answer": "Artificial intelligence is the simulation of human intelligence processes by computer systems. These processes include learning, reasoning, and self-correction. AI encompasses technologies such as machine learning, natural language processing, computer vision, and robotics.",
        "answers": [
            ("AI simulates human intelligence in machines, enabling them to learn, reason, and solve problems.", 90),
            ("It is the development of computer systems able to perform tasks that normally require human intelligence.", 88),
            ("Artificial intelligence allows computers to mimic cognitive functions like learning and problem-solving.", 85),
            ("Computer systems that can perform tasks requiring human-like intelligence, including reasoning and learning.", 87),
            ("AI involves creating algorithms that allow computers to learn from experience and make decisions.", 83),
            ("Technology that enables machines to simulate human thought processes and behavior.", 80),
            ("AI encompasses machine learning, NLP, computer vision, and robotics to create intelligent systems.", 84),
            ("The branch of computer science focused on building smart machines capable of human-level tasks.", 82),
            ("Intelligent machines that can understand language, recognize images, and make autonomous decisions.", 79),
            ("Systems designed to perform cognitive tasks intelligently without explicit step-by-step programming.", 77),
            ("AI makes computers do smart things like recognize speech or play chess.", 60),
            ("Machines that think and act like humans.", 52),
            ("Computer programs that can learn and improve.", 48),
            ("Smart software that can do human jobs.", 40),
            ("AI is when robots think.", 25),
            ("It is like when computers are smart.", 22),
            ("Computers doing human stuff.", 20),
            ("Something with robots and data.", 18),
            ("AI stands for artificial intelligence. I don't know more.", 8),
            ("It is the future of technology.", 12),
        ],
    },
    {
        "question": "Explain the water cycle.",
        "ideal_answer": "The water cycle describes the continuous movement of water within the Earth and atmosphere. It involves evaporation from water bodies, condensation forming clouds, precipitation as rain or snow, and collection in rivers, lakes, and oceans.",
        "answers": [
            ("The hydrological cycle moves water through evaporation, condensation, precipitation, and runoff continuously.", 95),
            ("Water evaporates from oceans, forms clouds through condensation, falls as precipitation, and returns to oceans.", 93),
            ("The continuous movement of water through evaporation, transpiration, condensation, and precipitation.", 91),
            ("Water cycle: evaporation from surfaces, cloud formation via condensation, rainfall, and collection in water bodies.", 89),
            ("Evaporation turns water into vapor, condensation forms clouds, precipitation falls, and water collects again.", 87),
            ("The cycle involves evaporation, condensation into clouds, precipitation, surface runoff, and groundwater recharge.", 85),
            ("Solar energy drives evaporation; condensation forms clouds; gravity causes precipitation and runoff.", 83),
            ("Water moves in a loop: ocean evaporation, cloud formation, rain or snow, river flow back to ocean.", 80),
            ("The water cycle continuously circulates water through the atmosphere and land via evaporation and precipitation.", 78),
            ("Evaporation from lakes and oceans, condensation into clouds, and precipitation back to earth.", 76),
            ("Water goes up as steam, forms clouds, and comes back down as rain.", 60),
            ("Evaporation makes water go into the air and then it rains.", 55),
            ("Rain comes from clouds. Clouds come from oceans.", 45),
            ("The water cycle is about rain and evaporation.", 42),
            ("Water goes up and comes back down.", 30),
            ("Water evaporates and rains again.", 35),
            ("I think water evaporates from the sea and it rains", 40),
            ("It is the way water moves on earth.", 28),
            ("Water changes states as it cycles through nature.", 50),
            ("Rain is part of the water cycle.", 22),
        ],
    },
    {
        "question": "What is machine learning?",
        "ideal_answer": "Machine learning is a subset of artificial intelligence that enables systems to learn and improve from experience without being explicitly programmed. It focuses on developing algorithms that can access data, learn from it, and make predictions or decisions.",
        "answers": [
            ("A branch of AI where algorithms learn patterns from data to make predictions without explicit programming.", 93),
            ("Machine learning enables computers to automatically improve their performance through experience.", 90),
            ("Systems that learn from training data to generalize patterns and make accurate predictions.", 88),
            ("The science of getting computers to learn and act like humans do without being explicitly programmed.", 85),
            ("ML algorithms detect statistical patterns in large datasets to produce predictive models.", 83),
            ("Deep learning, neural networks, and decision trees are all machine learning techniques.", 75),
            ("Computers learn from data examples to solve problems they were not explicitly programmed for.", 80),
            ("ML is training models on labeled data so they can classify or predict new examples.", 82),
            ("It is a method of data analysis that automates analytical model building using algorithms.", 78),
            ("Machine learning uses statistical techniques to give computers the ability to learn from data.", 77),
            ("Computers learn from examples without being told every rule.", 60),
            ("Training computers with lots of data so they get better over time.", 58),
            ("ML is when machines learn by themselves.", 50),
            ("Algorithms that improve as they process more data.", 55),
            ("Computers learning patterns from data.", 45),
            ("It helps computers predict things.", 40),
            ("I think machine learning is part of AI.", 30),
            ("Machine learning is programming.", 15),
            ("It is about teaching computers.", 25),
            ("Not sure, maybe it is about robots learning.", 10),
        ],
    },
    {
        "question": "What is democracy?",
        "ideal_answer": "Democracy is a system of government where citizens exercise power by voting. In a democracy, the people choose their leaders through free and fair elections. Key principles include rule of law, protection of individual rights, freedom of speech, and equality before law.",
        "answers": [
            ("Democracy is a government system where citizens elect representatives through free and fair elections.", 92),
            ("A political system in which supreme power is held by the people and exercised through elected representatives.", 90),
            ("Democracy ensures political equality, free speech, and governance through majority rule while protecting minority rights.", 88),
            ("A governance structure where citizens participate in decision-making through voting and elected officials.", 86),
            ("Democracy upholds the rule of law, individual freedoms, and representative government chosen by citizens.", 84),
            ("The foundational democratic principles include free elections, civil liberties, and checks on governmental power.", 82),
            ("Citizens choose their leaders in regular fair elections and enjoy basic human rights.", 80),
            ("A political system where power derives from the people who vote to select their government.", 79),
            ("Government of the people, by the people, for the people with protected individual rights.", 83),
            ("Democracy means free elections, peaceful transfer of power, and protection of civil liberties.", 78),
            ("People vote for their leaders in a democracy.", 60),
            ("A system where everyone votes and has equal rights.", 62),
            ("Citizens decide who governs them through elections.", 65),
            ("Democracy gives people the power to choose their government.", 58),
            ("It is when the people rule.", 40),
            ("Voting and freedom.", 30),
            ("Government chosen by people.", 45),
            ("Democracy is about elections.", 38),
            ("People can vote and have rights.", 48),
            ("I think everyone has a say.", 25),
        ],
    },
    {
        "question": "What is climate change?",
        "ideal_answer": "Climate change refers to long-term shifts in global temperatures and weather patterns. While these shifts can be natural, since the 1800s, human activities have been the main driver, primarily due to burning fossil fuels like coal, oil, and gas, which produce heat-trapping greenhouse gases.",
        "answers": [
            ("Long-term shifts in global temperatures and weather patterns mainly caused by greenhouse gas emissions from human activities.", 95),
            ("Climate change is the alteration of global climate patterns due to elevated CO2 and other greenhouse gases.", 92),
            ("Rising global temperatures and extreme weather events caused by burning fossil fuels and deforestation.", 90),
            ("The gradual increase in Earth's average temperature and resulting changes in weather due to human activities.", 88),
            ("Climate change encompasses global warming, more frequent extreme weather, and ecological disruption.", 86),
            ("Human emissions of CO2, methane, and other gases trap heat in the atmosphere causing climate disruption.", 84),
            ("Warming of Earth's climate system due to industrial emissions leading to sea level rise and extreme weather.", 82),
            ("Changed precipitation patterns, rising temperatures, and melting glaciers due to greenhouse gas buildup.", 80),
            ("Burning coal, oil, and gas releases CO2 which traps heat and changes the climate.", 78),
            ("It is the long-term transformation of temperature and weather patterns driven by human activity.", 83),
            ("Global warming due to pollution causing weird weather events.", 60),
            ("Earth is getting hotter because of carbon emissions.", 65),
            ("Climate is changing because we pollute too much.", 55),
            ("Weather patterns are shifting due to human activities.", 62),
            ("The planet is warming up because of greenhouse gases.", 58),
            ("Fossil fuels cause the climate to change.", 50),
            ("It is about the planet getting warmer.", 45),
            ("Weather is becoming more extreme.", 40),
            ("Climate change means more floods and droughts.", 48),
            ("The Earth is warming, I think because of pollution.", 42),
        ],
    },
    {
        "question": "What is a database?",
        "ideal_answer": "A database is an organized collection of structured information or data, typically stored electronically in a computer system. It is managed by a Database Management System (DBMS). Types include relational databases (using tables with rows and columns) and NoSQL databases.",
        "answers": [
            ("An organized electronic collection of structured data managed by a DBMS for efficient storage and retrieval.", 95),
            ("Databases store and manage structured data using tables, queries, and transactions controlled by DBMS software.", 92),
            ("A systematic collection of data that supports electronic storage, retrieval, and manipulation via management software.", 90),
            ("Relational databases use tables with rows and columns; NoSQL databases handle unstructured or semi-structured data.", 88),
            ("A database is software-managed storage for persistent, organized data accessible via SQL or other query languages.", 86),
            ("Organized data repository enabling fast retrieval, insertion, deletion, and modification of records.", 84),
            ("Systems like MySQL, PostgreSQL, and MongoDB organize data for efficient querying and management.", 82),
            ("A structured collection of data with defined relationships, managed by software to ensure integrity.", 80),
            ("Databases use schemas to define data structure and support CRUD operations for data management.", 78),
            ("It is a collection of related data organized for easy access, management, and updating.", 76),
            ("A database stores information in an organized way.", 65),
            ("It saves data so we can retrieve it later.", 60),
            ("Databases hold information for applications.", 58),
            ("SQL is used to query databases.", 55),
            ("Software that stores and retrieves data.", 52),
            ("A collection of organized data.", 48),
            ("Databases keep records organized.", 45),
            ("It is where app data is stored.", 42),
            ("I know databases store data in tables.", 50),
            ("Storage for digital information.", 38),
        ],
    },
    {
        "question": "Explain the greenhouse effect.",
        "ideal_answer": "The greenhouse effect is the process by which radiation from a planet's atmosphere warms the planet's surface to a temperature above what it would be without this atmosphere. Greenhouse gases like carbon dioxide, methane, and water vapor trap heat from the sun, preventing it from escaping back into space.",
        "answers": [
            ("Greenhouse gases trap outgoing infrared radiation, warming Earth's surface above what it would be otherwise.", 95),
            ("CO2, methane, and water vapor absorb heat re-radiated from Earth's surface, preventing it from escaping to space.", 93),
            ("Solar radiation passes through the atmosphere and warms the surface; greenhouse gases prevent heat escape.", 91),
            ("The atmosphere acts like a blanket: greenhouse gases absorb heat and warm the planet.", 88),
            ("Heat from the sun enters Earth's atmosphere but is trapped by CO2 and methane, warming the surface.", 86),
            ("Infrared radiation emitted by Earth is absorbed by greenhouse gases, returning it to the surface as heat.", 84),
            ("The natural process where atmospheric gases trap thermal energy maintaining habitable temperatures.", 82),
            ("Without greenhouse gases Earth would be much colder; they retain heat by absorbing infrared radiation.", 80),
            ("Burning fossil fuels increases greenhouse gas concentrations, enhancing the natural greenhouse effect.", 78),
            ("Gases like CO2 and methane act as an insulating layer trapping heat in Earth's lower atmosphere.", 76),
            ("Greenhouse gases trap heat from the sun and keep Earth warm.", 65),
            ("Carbon dioxide traps heat in the atmosphere.", 60),
            ("Gases around Earth stop heat from escaping.", 58),
            ("The atmosphere traps heat like a greenhouse.", 55),
            ("Heat gets trapped making Earth warmer.", 50),
            ("CO2 causes global warming through the greenhouse effect.", 52),
            ("The sun heats Earth and gases stop the heat from leaving.", 48),
            ("It is why Earth is warm enough for life.", 45),
            ("Certain gases keep Earth warm.", 42),
            ("Without it Earth would freeze.", 38),
        ],
    },
    {
        "question": "What is blockchain technology?",
        "ideal_answer": "Blockchain is a distributed, decentralized ledger technology that records transactions across many computers. Each block contains a cryptographic hash of the previous block, a timestamp, and transaction data. This makes the records resistant to modification, ensuring transparency and security.",
        "answers": [
            ("A decentralized distributed ledger where transactions are recorded in cryptographically linked blocks.", 95),
            ("Blockchain stores transaction records across a peer-to-peer network in tamper-resistant cryptographic blocks.", 92),
            ("Immutable, decentralized ledger technology securing data through cryptographic hashing of linked blocks.", 90),
            ("Each block contains transaction data and a hash of the previous block, creating an unalterable chain.", 88),
            ("Distributed ledger technology enabling trustless transactions without a central authority.", 86),
            ("Blockchain ensures data integrity through cryptographic proof chain; used in cryptocurrencies and supply chains.", 84),
            ("Consensus mechanisms like Proof of Work validate transactions added to the immutable blockchain.", 82),
            ("A shared, append-only database secured by cryptography ensuring transparency and preventing tampering.", 80),
            ("Decentralized network nodes maintain copies of the ledger, making manipulation extremely difficult.", 78),
            ("Technology that creates tamper-proof chains of transaction records across a computer network.", 83),
            ("Blockchain is the technology behind Bitcoin and other cryptocurrencies.", 62),
            ("It is a secure digital ledger for recording transactions.", 60),
            ("Data is stored in blocks that are linked together.", 55),
            ("Blockchain uses cryptography to secure transaction records.", 58),
            ("A chain of data blocks that is hard to change.", 50),
            ("It makes transactions transparent and secure.", 48),
            ("Decentralized record keeping system.", 45),
            ("Transactions are recorded in blocks.", 42),
            ("A secure way to store data without a central server.", 52),
            ("Bitcoin uses blockchain to track transactions.", 38),
        ],
    },
    {
        "question": "What is cybersecurity?",
        "ideal_answer": "Cybersecurity is the practice of protecting systems, networks, and programs from digital attacks. These cyberattacks are usually aimed at accessing, changing, or destroying sensitive information, extorting money, or interrupting normal business processes.",
        "answers": [
            ("Cybersecurity protects digital systems, networks, and data from unauthorized access, attacks, and damage.", 95),
            ("The practice of defending computers, servers, mobile devices, networks, and data from malicious attacks.", 93),
            ("Implementing security measures to protect digital infrastructure from cyber threats and unauthorized access.", 91),
            ("Cybersecurity encompasses encryption, access control, firewalls, and incident response to protect information.", 89),
            ("Defending against threats like malware, phishing, ransomware, and data breaches using layered security.", 87),
            ("The field of protecting computer systems and networks from theft, damage, and disruption.", 85),
            ("Security professionals use vulnerability assessment, penetration testing, and monitoring to prevent breaches.", 83),
            ("Cybersecurity ensures confidentiality, integrity, and availability of digital information assets.", 81),
            ("Protecting organizations from cyber attacks through policies, technologies, and employee training.", 79),
            ("The discipline of securing digital infrastructure from unauthorized access, theft, and destruction.", 84),
            ("Keeping computers and networks safe from hackers and attacks.", 65),
            ("Protecting data and systems from cyberattacks.", 62),
            ("Security for computers, networks, and software.", 60),
            ("Prevention of unauthorized access to systems and data.", 58),
            ("Defending against hackers and malware.", 55),
            ("It involves firewalls, encryption, and anti-virus software.", 52),
            ("Keeping digital information safe and secure.", 48),
            ("Preventing cyber threats to information systems.", 50),
            ("Protecting devices and data from digital threats.", 45),
            ("It is about keeping computers safe.", 35),
        ],
    },
    {
        "question": "What is cloud computing?",
        "ideal_answer": "Cloud computing is the delivery of computing services including servers, storage, databases, networking, software, and analytics over the internet. It offers faster innovation, flexible resources, and economies of scale. Common models include IaaS, PaaS, and SaaS.",
        "answers": [
            ("Delivery of on-demand computing resources including storage, servers, and applications over the internet.", 95),
            ("Cloud computing provides scalable IT resources via the internet without requiring local hardware investment.", 92),
            ("IaaS, PaaS, and SaaS are the main cloud service models delivering infrastructure, platforms, and software.", 90),
            ("Cloud services enable organizations to access computing power, storage, and software on demand.", 88),
            ("Remote servers hosted on the internet store, manage, and process data instead of local hardware.", 86),
            ("Cloud computing enables elastic resource allocation, pay-per-use pricing, and global accessibility.", 84),
            ("Major cloud providers like AWS, Azure, and GCP offer computing resources as a service over the internet.", 82),
            ("Organizations migrate to cloud for scalability, cost efficiency, and reduced maintenance overhead.", 80),
            ("Cloud allows businesses to scale resources up or down instantly based on demand.", 78),
            ("Internet-based computing services eliminating the need for owned physical infrastructure.", 76),
            ("Using internet servers instead of local computers to run software and store data.", 65),
            ("Storing data online and running software over the internet.", 62),
            ("Cloud computing means using remote servers for computing.", 60),
            ("Services like storage and software delivered over the internet.", 58),
            ("It lets you use computing resources without owning hardware.", 55),
            ("Running programs from the internet instead of your own computer.", 52),
            ("Google Drive and AWS are examples of cloud computing.", 50),
            ("Storing files and apps online.", 45),
            ("Computing power delivered over the internet.", 48),
            ("The cloud stores your data online.", 40),
        ],
    },
    {
        "question": "What is the Internet of Things?",
        "ideal_answer": "The Internet of Things refers to the network of physical devices, vehicles, appliances, and other objects embedded with sensors, software, and connectivity that enables them to collect and exchange data over the internet.",
        "answers": [
            ("IoT connects physical objects with embedded sensors to the internet to collect and exchange data.", 95),
            ("A network of interconnected smart devices that communicate and share data without human intervention.", 92),
            ("Physical devices embedded with sensors, software, and connectivity forming an intelligent network.", 90),
            ("IoT enables everyday objects like thermostats and wearables to connect to the internet and share data.", 88),
            ("Billions of connected devices exchange real-time data enabling smart homes, cities, and industries.", 86),
            ("Embedded computing in physical objects allows them to interact with their environment and the internet.", 84),
            ("IoT devices use protocols like MQTT and CoAP to transmit sensor data to cloud platforms.", 82),
            ("Smart devices, appliances, and vehicles share data over the internet enabling automation.", 80),
            ("Networks of connected physical devices collecting environmental data and enabling automated responses.", 78),
            ("IoT links objects to the internet so they can monitor, report, and act on sensor information.", 83),
            ("Devices connected to the internet that can share data and be controlled remotely.", 65),
            ("Smart devices like Alexa and smart thermostats are examples of IoT.", 62),
            ("Physical objects connected to the internet.", 60),
            ("Devices communicating with each other over the internet.", 58),
            ("Appliances and gadgets that are connected to the internet.", 55),
            ("Smart home devices are part of the IoT.", 52),
            ("Things like smart fridges that connect to the internet.", 48),
            ("Connecting everyday objects to the internet.", 45),
            ("Devices sharing data through the internet.", 42),
            ("The internet connecting physical things.", 38),
        ],
    },
    {
        "question": "What is an operating system?",
        "ideal_answer": "An operating system is software that manages computer hardware and software resources and provides common services for computer programs. It acts as an intermediary between users and the computer hardware. Examples include Windows, macOS, and Linux.",
        "answers": [
            ("System software managing hardware resources, scheduling processes, and providing services to applications.", 95),
            ("An OS abstracts hardware, manages memory and processes, and provides a user interface for programs.", 93),
            ("Core software layer controlling hardware resources and enabling application execution on a computer.", 91),
            ("The OS kernel manages CPU scheduling, memory allocation, and device drivers for the entire system.", 89),
            ("Windows, macOS, and Linux are operating systems that manage hardware and run software applications.", 87),
            ("Operating systems provide process management, file system control, and hardware abstraction.", 85),
            ("The OS acts as intermediary between user applications and computer hardware.", 83),
            ("System software that provides a stable environment for applications to run on hardware.", 81),
            ("An OS manages multitasking, memory, storage, and user interfaces for computing devices.", 79),
            ("Fundamental software that controls all hardware and software operations on a computer.", 84),
            ("Software that controls the computer and runs other programs.", 65),
            ("Windows and macOS are examples of operating systems.", 62),
            ("The OS manages computer resources so programs can run.", 60),
            ("It is the main software that controls a computer.", 58),
            ("Software that helps programs run on computer hardware.", 55),
            ("An operating system manages memory and processes.", 52),
            ("It is what runs your computer.", 45),
            ("Software that makes computers work.", 42),
            ("OS controls hardware resources.", 50),
            ("The system software on a computer.", 38),
        ],
    },
    {
        "question": "Describe the human circulatory system.",
        "ideal_answer": "The circulatory system transports blood, nutrients, oxygen, and waste products through the body. It consists of the heart (pump), blood vessels (arteries, veins, capillaries), and blood. The heart pumps oxygenated blood through arteries and deoxygenated blood returns through veins.",
        "answers": [
            ("The cardiovascular system circulates blood via the heart through arteries and veins to deliver oxygen and nutrients.", 95),
            ("Heart pumps oxygenated blood through arteries; deoxygenated blood returns via veins to the heart and lungs.", 93),
            ("Closed circulatory system: heart, arteries, capillaries, veins transport blood, oxygen, and nutrients.", 91),
            ("The heart beats to push blood through blood vessels delivering oxygen and removing waste.", 89),
            ("Arteries carry blood from the heart; veins return it; capillaries enable nutrient and gas exchange.", 87),
            ("Double circulation: pulmonary circuit for lungs, systemic circuit for body tissues.", 85),
            ("The circulatory system maintains homeostasis by transporting hormones, nutrients, and waste.", 83),
            ("Cardiac muscle pumps blood through a closed network of vessels enabling gas and nutrient exchange.", 81),
            ("Blood containing red and white cells circulates via the heart-driven vascular network.", 79),
            ("The cardiovascular system moves blood to deliver oxygen to cells and remove carbon dioxide.", 84),
            ("The heart pumps blood around the body through blood vessels.", 65),
            ("Blood carries oxygen and nutrients to all parts of the body.", 62),
            ("Arteries and veins carry blood through the body.", 60),
            ("The circulatory system delivers oxygen using blood.", 58),
            ("Heart, blood, and vessels form the circulatory system.", 55),
            ("Blood transports oxygen from lungs to body cells.", 52),
            ("The heart pumps oxygenated blood to tissues.", 50),
            ("Veins and arteries circulate blood.", 45),
            ("The bloodstream carries nutrients throughout the body.", 48),
            ("Blood goes from heart through arteries to veins and back.", 42),
        ],
    },
    {
        "question": "What is Newton's first law of motion?",
        "ideal_answer": "Newton's first law states that an object at rest stays at rest and an object in motion stays in motion with the same speed and direction unless acted upon by an unbalanced external force. This is also known as the law of inertia.",
        "answers": [
            ("The law of inertia: objects maintain their state of rest or uniform motion unless acted upon by a net force.", 95),
            ("An object at rest stays at rest; an object in motion stays in motion unless an external force acts on it.", 93),
            ("Newton's first law states that velocity is constant in the absence of a net external force.", 91),
            ("A body continues in its state of uniform motion or rest unless compelled by an external force to change.", 89),
            ("Inertia keeps objects in their current state of motion unless acted on by an unbalanced force.", 87),
            ("The first law explains why you need a force to change an object's speed or direction.", 85),
            ("Mass resists changes in velocity due to inertia as described by Newton's first law.", 83),
            ("Objects remain in uniform motion unless a net external force causes acceleration.", 81),
            ("Seat belts are needed because passengers continue moving when a car stops suddenly—due to inertia.", 79),
            ("Newton's first law: without force, motion remains constant—basis for understanding dynamics.", 84),
            ("An object keeps moving or stays still unless a force acts on it.", 65),
            ("Things stay still or keep moving unless pushed or pulled.", 62),
            ("Without a force, objects don't change their motion.", 60),
            ("Inertia means objects resist changes in their motion.", 58),
            ("A ball rolls until friction slows it down, showing Newton's first law.", 55),
            ("Newton's first law is about inertia and staying in motion.", 52),
            ("Objects at rest stay at rest unless a force acts.", 50),
            ("The law of inertia states objects keep moving.", 45),
            ("Stuff doesn't move until you push it.", 35),
            ("Newton's first law is about forces and motion.", 30),
        ],
    },
    {
        "question": "What is the theory of evolution?",
        "ideal_answer": "The theory of evolution by natural selection, proposed by Charles Darwin, states that organisms with traits better suited to their environment are more likely to survive and reproduce. Over generations, beneficial traits become more common, leading to the gradual change of species.",
        "answers": [
            ("Darwin's theory: organisms with advantageous traits are more likely to survive and pass those traits on.", 95),
            ("Natural selection drives evolution by favoring organisms whose traits better suit their environment.", 93),
            ("Evolution through natural selection explains biodiversity as species gradually adapt over generations.", 91),
            ("Heritable traits that improve survival and reproduction become more common in populations over time.", 89),
            ("Darwin showed that species change through natural selection, mutation, and genetic drift over generations.", 87),
            ("The modern synthesis combines Darwin's natural selection with Mendelian genetics to explain evolution.", 85),
            ("Beneficial mutations spread through a population because they improve survival and reproduction.", 83),
            ("Evolution explains the diversity of life through gradual genetic change over vast time periods.", 81),
            ("Common descent through natural selection explains why all life shares biochemical mechanisms.", 79),
            ("Natural selection gradually transforms species as favorable traits accumulate over generations.", 84),
            ("Species change over time through natural selection—organisms that fit their environment survive.", 65),
            ("Darwin's theory explains how species adapt and change over generations.", 62),
            ("Organisms better suited to their environment survive and reproduce.", 60),
            ("Evolution is the gradual change of species over time.", 58),
            ("Natural selection favors traits that help survival.", 55),
            ("Evolution explains why species adapt to their environments.", 52),
            ("Survival of the fittest means well-suited organisms reproduce more.", 50),
            ("Darwin proposed that species evolve through natural selection.", 48),
            ("Animals evolve over many generations.", 40),
            ("Evolution is when animals change over time.", 35),
        ],
    },
    {
        "question": "What is DNA?",
        "ideal_answer": "DNA (deoxyribonucleic acid) is the hereditary material in humans and almost all other organisms. It has a double helix structure with sugar-phosphate backbones and nitrogenous base pairs (adenine-thymine, guanine-cytosine) that encode genetic information.",
        "answers": [
            ("DNA is the double-helix molecule carrying genetic instructions for development, functioning, and reproduction.", 95),
            ("Deoxyribonucleic acid encodes genes in sequences of base pairs: A-T and G-C.", 93),
            ("DNA's double helix consists of two strands of nucleotides with complementary base pairing.", 91),
            ("Genetic information is stored in DNA as sequences of four bases: adenine, thymine, guanine, cytosine.", 89),
            ("DNA replication, transcription, and translation transfer genetic information from DNA to proteins.", 87),
            ("Chromosomes contain coiled DNA encoding thousands of genes that determine inherited traits.", 85),
            ("The double helix structure of DNA allows accurate replication and information storage.", 83),
            ("DNA mutation and genetic recombination drive evolution and variation in organisms.", 81),
            ("Each cell contains a complete copy of an organism's DNA encoding all genetic information.", 79),
            ("DNA stores hereditary information in base pair sequences that determine traits passed to offspring.", 84),
            ("DNA carries genetic information in the form of base pair sequences.", 65),
            ("The double helix of DNA encodes our genes.", 62),
            ("DNA is the molecule carrying our genetic code.", 60),
            ("Adenine pairs with thymine and guanine pairs with cytosine in DNA.", 58),
            ("DNA is found in the nucleus and contains our genes.", 55),
            ("DNA determines our physical traits like eye color.", 52),
            ("Deoxyribonucleic acid stores genetic information.", 50),
            ("DNA is a long molecule with genetic instructions.", 48),
            ("Our genes are made of DNA.", 42),
            ("DNA looks like a twisted ladder.", 38),
        ],
    },
    {
        "question": "What is mitosis?",
        "ideal_answer": "Mitosis is the process of cell division where a single cell divides to produce two identical daughter cells. It involves phases: prophase (chromosomes condense), metaphase (chromosomes align), anaphase (chromosomes separate), and telophase (nuclear membranes reform), followed by cytokinesis.",
        "answers": [
            ("Mitosis produces two genetically identical daughter cells through prophase, metaphase, anaphase, and telophase.", 95),
            ("Cell division by mitosis ensures each daughter cell receives a complete identical copy of the genome.", 93),
            ("The mitotic phases: chromosomes condense, align at the equator, separate, and nuclear envelopes reform.", 91),
            ("Mitosis enables growth and tissue repair by producing genetically identical daughter cells.", 89),
            ("During mitosis replicated chromosomes are separated into two identical nuclei followed by cytokinesis.", 87),
            ("The cell cycle phases PMAT—prophase, metaphase, anaphase, telophase—describe mitotic cell division.", 85),
            ("Spindle fibers attach to centromeres and pull sister chromatids to opposite poles during mitosis.", 83),
            ("Mitosis differs from meiosis in producing diploid identical cells rather than haploid gametes.", 81),
            ("Chromosomes condense and separate into two nuclei during mitosis enabling asexual reproduction.", 79),
            ("Cell division by mitosis maintains chromosomal number producing genetically identical somatic cells.", 84),
            ("Mitosis produces two identical cells from one parent cell.", 65),
            ("Cell division where chromosomes duplicate and split into two identical cells.", 62),
            ("Mitosis has four stages: prophase, metaphase, anaphase, telophase.", 60),
            ("The cell divides to produce two identical daughter cells in mitosis.", 58),
            ("Mitosis allows growth by dividing cells.", 55),
            ("Chromosomes line up and separate during mitosis.", 52),
            ("Cell division process producing identical cells.", 50),
            ("Mitosis is how cells reproduce asexually.", 48),
            ("A cell splits into two during mitosis.", 42),
            ("Mitosis creates new identical cells.", 38),
        ],
    },
    {
        "question": "What is gravity?",
        "ideal_answer": "Gravity is a fundamental force of nature that attracts any two objects with mass toward each other. According to Newton's law of universal gravitation, the gravitational force is proportional to the product of the masses and inversely proportional to the square of the distance between them.",
        "answers": [
            ("Gravity is the attractive force between masses, described by Newton's inverse-square law.", 95),
            ("The gravitational force is proportional to mass and inversely proportional to the square of distance.", 93),
            ("Every mass exerts an attractive gravitational force on every other mass, as described by Newton.", 91),
            ("Gravity keeps planets in orbit, causes objects to fall, and holds galaxies together.", 89),
            ("Einstein described gravity as the curvature of spacetime caused by mass and energy.", 87),
            ("The gravitational constant G determines the strength of gravity between masses in Newton's formula.", 85),
            ("Gravity is the weakest fundamental force but dominates at astronomical scales due to infinite range.", 83),
            ("Newton's universal gravitation law: F = Gm1m2/r² predicts gravitational attraction between masses.", 81),
            ("Gravitational waves are ripples in spacetime caused by accelerating massive objects.", 79),
            ("Gravity causes free-fall acceleration of 9.8 m/s² near Earth's surface.", 84),
            ("Gravity is what pulls objects toward each other.", 65),
            ("The force of gravity keeps us on the ground.", 62),
            ("Gravity attracts objects with mass toward each other.", 60),
            ("Newton discovered that masses attract each other gravitationally.", 58),
            ("Gravity keeps planets orbiting the sun.", 55),
            ("The gravitational force depends on mass and distance.", 52),
            ("Gravity pulls objects toward Earth's center.", 50),
            ("Everything with mass is attracted by gravity.", 48),
            ("Gravity is why things fall down.", 40),
            ("Gravity makes objects fall.", 35),
        ],
    },
    {
        "question": "What is sustainable development?",
        "ideal_answer": "Sustainable development is development that meets the needs of the present without compromising the ability of future generations to meet their own needs. It balances economic growth, environmental protection, and social well-being.",
        "answers": [
            ("Development meeting present needs without compromising future generations' ability to meet theirs.", 95),
            ("Sustainable development balances economic growth, environmental protection, and social inclusion.", 93),
            ("The triple bottom line of sustainable development: people, planet, and profit in balance.", 91),
            ("Sustainable development integrates economic progress with ecological conservation for long-term prosperity.", 89),
            ("Meeting current needs while preserving resources and ecosystems for future generations.", 87),
            ("UN Sustainable Development Goals address poverty, climate, health, and equality for sustainable futures.", 85),
            ("Sustainability requires balancing economic activity with environmental limits and social equity.", 83),
            ("Development that does not deplete natural resources or degrade the environment for future generations.", 81),
            ("Green economy approaches integrate environmental considerations into economic planning.", 79),
            ("Responsible development that preserves biodiversity and natural capital for future generations.", 84),
            ("Development that takes care of the environment and future generations.", 65),
            ("Sustainable development balances economy and environment.", 62),
            ("Meeting today's needs without harming future generations' ability to meet theirs.", 60),
            ("Economic growth that protects the environment.", 58),
            ("Development that preserves resources for future use.", 55),
            ("Balancing growth with environmental protection.", 52),
            ("Using resources wisely for future generations.", 50),
            ("Development that is environmentally responsible.", 48),
            ("Growth that doesn't damage the planet.", 42),
            ("Sustainable means not using up all resources.", 38),
        ],
    },
    {
        "question": "What is supply and demand?",
        "ideal_answer": "Supply and demand is a fundamental economic model describing the relationship between the availability of a product (supply) and the desire for it (demand). When demand exceeds supply, prices rise. When supply exceeds demand, prices fall. The equilibrium price is where supply equals demand.",
        "answers": [
            ("Supply and demand determines market prices: high demand with low supply raises prices, and vice versa.", 95),
            ("Market equilibrium is reached where quantity supplied equals quantity demanded at a given price level.", 93),
            ("The law of supply and demand: prices rise when demand exceeds supply and fall when supply exceeds demand.", 91),
            ("Supply curves slope upward; demand curves slope downward; their intersection gives equilibrium price.", 89),
            ("Competitive markets self-regulate through supply and demand to allocate scarce resources efficiently.", 87),
            ("Price elasticity measures how sensitive supply and demand are to changes in price.", 85),
            ("Shifts in consumer preferences, income, or production costs displace supply and demand curves.", 83),
            ("Supply and demand analysis underlies most microeconomic decisions and market outcomes.", 81),
            ("Excess supply leads to price decreases; excess demand causes prices to rise toward equilibrium.", 79),
            ("Market prices emerge from the interaction of producers supplying goods and consumers demanding them.", 84),
            ("When demand is high and supply is low, prices go up.", 65),
            ("Supply and demand determines prices in a free market.", 62),
            ("If supply decreases and demand stays the same, prices rise.", 60),
            ("The price of goods is determined by supply and demand.", 58),
            ("High demand and low supply cause prices to increase.", 55),
            ("Market prices reflect the balance of supply and demand.", 52),
            ("Prices fall when supply exceeds demand.", 50),
            ("The law of supply and demand governs market prices.", 48),
            ("More demand than supply means higher prices.", 42),
            ("Supply and demand is about prices and quantities.", 38),
        ],
    },
    {
        "question": "What is the solar system?",
        "ideal_answer": "The solar system consists of the Sun and all objects that orbit it, including eight planets, dwarf planets, moons, asteroids, comets, and meteoroids. The planets in order are Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, and Neptune.",
        "answers": [
            ("The solar system contains the Sun and eight planets: Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune.", 95),
            ("Our solar system includes the Sun, planets, moons, dwarf planets, asteroids, and comets.", 93),
            ("Gravitational attraction binds the Sun, planets, and smaller bodies forming the solar system.", 91),
            ("Eight planets orbit the Sun; rocky inner planets and gas giants in the outer solar system.", 89),
            ("The solar system formed from a collapsing nebula about 4.6 billion years ago.", 87),
            ("Jupiter is the largest planet; Mercury is closest to the Sun; Neptune is farthest.", 85),
            ("Kepler's laws describe elliptical planetary orbits and orbital period relationships in the solar system.", 83),
            ("The solar system's habitable zone contains Earth, the only known planet with liquid water.", 81),
            ("Comets and asteroids in the solar system are remnants of the planetary formation era.", 79),
            ("Pluto was reclassified as a dwarf planet; there are now eight official planets in our solar system.", 84),
            ("Our solar system has eight planets orbiting the Sun.", 65),
            ("The solar system includes the Sun, planets, and moons.", 62),
            ("Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, Neptune orbit the Sun.", 60),
            ("The Sun is the center of our solar system.", 58),
            ("Planets orbit the Sun in the solar system.", 55),
            ("We live in the solar system on Earth.", 52),
            ("The solar system is in the Milky Way galaxy.", 50),
            ("The eight planets orbit the Sun.", 48),
            ("Our solar system has gas giants and rocky planets.", 45),
            ("Space is mostly empty in the solar system.", 38),
        ],
    },
    {
        "question": "What is object-oriented programming?",
        "ideal_answer": "Object-oriented programming is a programming paradigm based on the concept of objects, which contain data in the form of fields (attributes) and code in the form of procedures (methods). Key principles include encapsulation, inheritance, polymorphism, and abstraction.",
        "answers": [
            ("OOP organizes code around objects with attributes and methods, using encapsulation, inheritance, and polymorphism.", 95),
            ("A programming paradigm using objects—instances of classes—to encapsulate state and behavior.", 93),
            ("OOP principles: encapsulation bundles data, inheritance shares code, polymorphism enables flexibility.", 91),
            ("Classes define blueprints; objects are instances with their own state and behavior.", 89),
            ("OOP promotes code reuse through inheritance and loose coupling through abstraction.", 87),
            ("Encapsulation hides implementation details; polymorphism allows different objects to respond to same interface.", 85),
            ("Design patterns like Factory, Singleton, and Observer apply OOP principles in software architecture.", 83),
            ("Abstract classes and interfaces define contracts that promote polymorphism in OOP.", 81),
            ("Languages like Python, Java, and C++ support OOP for modular, maintainable software.", 79),
            ("OOP's four pillars—encapsulation, abstraction, inheritance, polymorphism—form the foundation of software design.", 84),
            ("OOP uses classes and objects to structure code.", 65),
            ("Encapsulation, inheritance, and polymorphism are OOP principles.", 62),
            ("Programming using objects that have data and methods.", 60),
            ("Classes are blueprints for objects in OOP.", 58),
            ("OOP promotes code reuse through inheritance.", 55),
            ("In OOP, objects interact by calling each other's methods.", 52),
            ("Java and Python are object-oriented languages.", 50),
            ("OOP makes code more organized and reusable.", 48),
            ("Objects have attributes and can perform actions.", 45),
            ("OOP is a way to organize programs using objects.", 42),
        ],
    },
    {
        "question": "What is encryption?",
        "ideal_answer": "Encryption is the process of converting plain text into cipher text using an algorithm and a key. Only authorized parties with the correct decryption key can convert the cipher text back to readable plain text. Common methods include symmetric encryption (same key) and asymmetric encryption (public-private key pair).",
        "answers": [
            ("Encryption converts plaintext to ciphertext using an algorithm and key; only authorized parties can decrypt.", 95),
            ("Symmetric encryption uses one shared key; asymmetric uses public-private key pairs for secure communication.", 93),
            ("AES is a widely used symmetric encryption standard; RSA is a common asymmetric algorithm.", 91),
            ("Encryption ensures data confidentiality by making it unreadable without the correct decryption key.", 89),
            ("TLS/SSL protocols use encryption to secure data transmitted over the internet.", 87),
            ("End-to-end encryption ensures only sender and recipient can read messages, even from service providers.", 85),
            ("Cryptographic keys must be securely managed; key compromise renders encryption useless.", 83),
            ("Hash functions like SHA-256 create fixed-size digests; encryption is reversible with the key.", 81),
            ("Encryption protects data at rest, data in transit, and data in use from unauthorized access.", 79),
            ("Digital signatures use asymmetric encryption to verify authenticity and integrity of messages.", 84),
            ("Encryption scrambles data so only authorized people with a key can read it.", 65),
            ("Data is encrypted using an algorithm and can only be decrypted with the correct key.", 62),
            ("Symmetric and asymmetric are the two main encryption types.", 60),
            ("Encryption protects sensitive information during transmission.", 58),
            ("AES and RSA are common encryption algorithms.", 55),
            ("Encrypting data makes it unreadable without a key.", 52),
            ("Encryption is used to secure passwords and communications.", 50),
            ("Data is locked with encryption so hackers cannot read it.", 48),
            ("Encryption converts data into a code.", 42),
            ("Encrypted data is protected by a key.", 38),
        ],
    },
    {
        "question": "What are neural networks?",
        "ideal_answer": "A neural network is a computing system inspired by biological neural networks in the human brain. It consists of layers of interconnected nodes (neurons) that process information using weighted connections. Neural networks learn by adjusting weights through training on data using backpropagation.",
        "answers": [
            ("Neural networks are layered models of artificial neurons that learn to solve problems from training data.", 95),
            ("Interconnected layers of artificial neurons that adjust weights through backpropagation to learn.", 93),
            ("Deep neural networks with many hidden layers can learn hierarchical representations of complex data.", 91),
            ("Convolutional neural networks excel at image recognition; recurrent networks handle sequential data.", 89),
            ("Neural network training minimizes a loss function using gradient descent and backpropagation.", 87),
            ("Activation functions like ReLU introduce non-linearity enabling neural networks to learn complex patterns.", 85),
            ("Overfitting in neural networks is addressed by regularization, dropout, and early stopping.", 83),
            ("Transformer architectures revolutionized NLP by enabling large-scale language models like GPT.", 81),
            ("Neural networks extract features automatically from raw data through learned weight matrices.", 79),
            ("Backpropagation computes gradients and updates weights to reduce prediction errors in neural networks.", 84),
            ("Neural networks mimic the brain using connected layers of artificial neurons.", 65),
            ("Deep learning uses neural networks with many layers.", 62),
            ("Neural networks learn patterns from training data.", 60),
            ("Backpropagation is used to train neural networks.", 58),
            ("A neural network has input, hidden, and output layers.", 55),
            ("Weights in a neural network are adjusted during training.", 52),
            ("Neural networks can recognize images and text.", 50),
            ("Deep learning neural networks can solve complex problems.", 48),
            ("Artificial neurons pass signals through a network.", 45),
            ("Neural networks learn from data examples.", 42),
        ],
    },
]

# ── generate new rows ────────────────────────────────────────────────────────
random.seed(42)
needed = TARGET_ROWS - len(unique_rows)
print(f"\nGenerating {needed} additional unique rows …")

new_rows = []
next_id  = len(unique_rows) + 1

for topic in topics:
    q = topic["question"]
    ia = topic["ideal_answer"]
    for student_ans, score in topic["answers"]:
        if student_ans.strip().lower() not in seen_answers:
            seen_answers.add(student_ans.strip().lower())
            new_rows.append({
                "id": str(next_id),
                "question": q,
                "ideal_answer": ia,
                "student_answer": student_ans,
                "human_score": str(score),
            })
            next_id += 1

# If still not enough, generate slightly varied versions
filler_templates = [
    ("The answer is: {core}", -5),
    ("{core} That is my understanding.", +2),
    ("In my view, {core}", +1),
    ("Based on what I know, {core}", +1),
    ("To summarize, {core}", 0),
    ("{core} I believe this is correct.", +1),
    ("From what I have learned, {core}", +1),
    ("As far as I know, {core}", -2),
    ("Simply put, {core}", 0),
    ("In essence, {core}", +1),
    ("According to my studies, {core}", +1),
    ("To put it another way, {core}", 0),
    ("My understanding is that {core}", -1),
    ("{core} This is how I understand it.", +1),
    ("What I recall is that {core}", -1),
    ("I learned that {core}", 0),
    ("It can be explained as: {core}", 0),
    ("Broadly speaking, {core}", 0),
    ("In other words, {core}", 0),
    ("Basically, {core}", -2),
    ("I think {core}", -3),
    ("I believe that {core}", -2),
    ("From my perspective, {core}", 0),
    ("As I understand it, {core}", -1),
    ("One way to put it: {core}", 0),
    ("The concept is: {core}", -1),
    ("If I recall correctly, {core}", -2),
    ("My answer is that {core}", 0),
    ("This concept means: {core}", -1),
    ("An important point is that {core}", +1),
]

if len(unique_rows) + len(new_rows) < TARGET_ROWS:
    still_needed = TARGET_ROWS - (len(unique_rows) + len(new_rows))
    print(f"  Still need {still_needed} rows — generating variants …")
    all_base_answers = [(t["question"], t["ideal_answer"], a, s) for t in topics for a, s in t["answers"]]
    added = 0
    # Repeat enough times to generate enough variants
    repeat = (still_needed // len(all_base_answers)) + 5
    for _ in range(repeat):
        random.shuffle(all_base_answers)
        for q, ia, base_ans, base_score in all_base_answers:
            if len(new_rows) >= needed:
                break
            tmpl, delta = random.choice(filler_templates)
            core = base_ans.rstrip(".").rstrip("!").rstrip("?")
            variant = tmpl.replace("{core}", core)
            key = variant.strip().lower()
            if key not in seen_answers:
                seen_answers.add(key)
                score = max(0, min(100, base_score + delta))
                new_rows.append({
                    "id": str(next_id),
                    "question": q,
                    "ideal_answer": ia,
                    "student_answer": variant,
                    "human_score": str(score),
                })
                next_id += 1
                added += 1
        if len(new_rows) >= needed:
            break
    print(f"  Added {added} variant rows")

# ── merge & save ─────────────────────────────────────────────────────────────
# Reset IDs sequentially
all_rows = unique_rows + new_rows
for i, row in enumerate(all_rows, start=1):
    row["id"] = str(i)

print(f"\nTotal rows in final dataset: {len(all_rows)}")

fieldnames = ["id", "question", "ideal_answer", "student_answer", "human_score"]
with open(OUTPUT_FILE, "w", newline="", encoding="utf-8") as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()
    writer.writerows(all_rows)

print(f"Saved to: {OUTPUT_FILE}")
print("Done!")
